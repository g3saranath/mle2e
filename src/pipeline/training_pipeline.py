''' 
This is the training pipeline
'''